apiVersion: v1
kind: Secret
metadata:
  name: zomboid-passwords
type: Opaque
stringData:
  admin-password: "tread with care"
  server-password: "let me in"
---
apiVersion: horde.host/v1
kind: BackupDestination
metadata:
  labels:
    app.kubernetes.io/name: zomboid-operator
    app.kubernetes.io/managed-by: kustomize
  name: dropbox-destination
spec:
  dropbox:
    remotePath: "/my/test/path"
    refreshToken:
      name: dropbox-token
      key: refresh-token
---
apiVersion: horde.host/v1
kind: ZomboidServer
metadata:
  name: zomboidserver-with-backups
spec:
  version: "41.78.16-20241106121439"
  resources:
    requests:
      memory: "2Gi"
      cpu: "500m"
    limits:
      memory: "3Gi"
      cpu: "1"
  storage:
    storageClassName: "standard"
    request: "2Gi"
    workshopRequest: "1Gi"
  backups:
    storageClassName: "standard"
    request: "2Gi"
  administrator:
    username: "admin"
    password:
      name: zomboid-passwords
      key: admin-password
  password:
    name: zomboid-passwords
    key: server-password
---
apiVersion: horde.host/v1
kind: ZomboidBackupPlan
metadata:
  labels:
    app.kubernetes.io/name: zomboid-operator
    app.kubernetes.io/managed-by: kustomize
  name: backup-my-server-to-dropbox
spec:
  server:
    name: zomboidserver-with-backups
  destination:
    name: dropbox-destination
  schedule: "0 0 * * *"
